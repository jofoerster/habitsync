<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <title layout:title-pattern="$CONTENT_TITLE - Habit Tracker">Habit Tracker</title>
    <meta charset="UTF-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>

    <!-- PWA Manifest and Theme -->
    <link href="/manifest.json" rel="manifest">
    <meta content="#1976d2" name="theme-color">
    <link href="/icons/icon-192x192.png" rel="apple-touch-icon">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <th:block layout:fragment="css"></th:block>
</head>
<body>
<div id="loading-overlay">
    <div class="spinner"></div>
</div>
<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1 class="h3" layout:fragment="page-title">Default Title</h1>
    </div>

    <div class="alert alert-success alert-dismissible fade show" role="alert" th:if="${message}">
        <i class="bi bi-check-circle-fill me-2"></i>
        <span th:text="${message}"></span>
        <button aria-label="Close" class="btn-close" data-bs-dismiss="alert" type="button"></button>
    </div>

    <div class="alert alert-danger alert-dismissible fade show" role="alert" th:if="${error}">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        <span th:text="${error}"></span>
        <button aria-label="Close" class="btn-close" data-bs-dismiss="alert" type="button"></button>
    </div>

    <!-- Main content area -->
    <div layout:fragment="content">
        <!-- Content will be replaced by specific pages -->
    </div>
</div>

<!-- Floating Action Button -->
<th:block layout:fragment="fab"></th:block>

<!-- Bottom Navigation -->
<div class="bottom-nav">
    <a class="bottom-nav-item" href="/habit/tracker" th:classappend="${active == 'tracker' ? 'active' : ''}">
        <div class="bottom-nav-icon"><i class="bi bi-pencil"></i></div>
        <div>Tracker</div>
    </a>

    <a class="bottom-nav-item" href="/habits" th:classappend="${active == 'home' ? 'active' : ''}">
        <div class="bottom-nav-icon"><i class="bi bi-house"></i></div>
        <div>Habits</div>
    </a>
    <a class="bottom-nav-item" href="/challenge" th:classappend="${active == 'statistics' ? 'active' : ''}">
        <div class="bottom-nav-icon"><i class="bi bi-bar-chart"></i></div>
        <div>Challenges</div>
    </a>
    <a class="bottom-nav-item" href="/notification/list">
        <div class="bottom-nav-icon"><i class="bi bi-bell me-1"></i>
        </div>
        <div th:text="${pendingNotifications != null && pendingNotifications != 0 ? 'Notifications (' + pendingNotifications + ')' : 'Notifications'}">
            Notifications
        </div>
    </a>
    <a class="bottom-nav-item" href="/profile" th:classappend="${active == 'profile' ? 'active' : ''}">
        <div class="bottom-nav-icon"><i class="bi bi-person"></i></div>
        <div>Profile</div>
    </a>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<script defer th:src="@{/js/layout.js}"></script>

<th:block layout:fragment="scripts"></th:block>

</body>
</html>
